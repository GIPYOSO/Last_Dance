<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>분양 리스트</title>
    <link rel="icon" type="images/png" sizes="32x32" href="images/favicon-32x32.png">
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/header.js"></script>
    <link rel="stylesheet" href="css/import.css">
</head>
<body>
    <header class="ColorH">
        <h1><a href="index.html"><img src="images/Color_Logo.png" alt=""></a></h1>
        <nav>
            <button type="button" class="bobile">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="gnb clear">
                <li>운영정보
                    <ul>
                        <li><a href="Notification_information.html">질병정보</a></li>
                        <li><a href="operation_information.html ">작물 농사 방법</a></li>
                    </ul>
                </li>
                <li>분양정보
                    <ul>
                        <li><a href="Sale_list.html">분양리스트</a></li>
                    </ul>
                </li>
                <li>소통
                    <ul>
                        <li><a href="bulletin_board.html">자유 게시판</a></li>
                        <li><a href="Questions_ board.html">질문</a></li>
                        <li><a href="Notice.html">공지사항</a></li>
                    </ul>
                </li>
                <li>공유
                    <ul>
                        <li><a href="Selling.html">내 작물 판매</a></li>
                        <li><a href="Free_selling.html">내 작물 무료나눔</a></li>
                    </ul>
                </li>
                <li><a href="MyPage.html">마이페이지</a></li>
            </ul>
        </nav>
        <span class="login"><a href="login.html">로그인</a></span>
    </header>
    
    <section class="mapS">
        <!--  리스트 넣는곳 SJH-->
        
        <!--  리스트 넣는곳 SJH  끝-->
        <div class="mapbox" id="map"></div>

        <div class="mapslist" id="mapsSalelist">
        </div>
    </section>

    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=28421dfec276c9cf96871dabc9d7c067"></script>

    <script>
        
        // 분양 정보 가져오기  SJH  
        var url = 'http://openapi.seoul.go.kr:8088/77445a7a5673736532377070516153/json/vNtcnNgc002/1/100/'; /* URL */
        
        var arrSalelist = [];
            $.ajax({
            url: url, //API Call
            dataType: "json",
            type: "GET",
            success: function(data) {

                console.log('Received data:', data.vNtcnNgc002.row) // For testing
                var tmp = "";
                $.each(data.vNtcnNgc002.row, function(index, val) {
                    tmp += "<ul>"
                    tmp += "<li onclick='map_load(\""+val.LA+"\",\""+val.LO+" \",\""+val.ATDRC_CODE+" \",\""+val.SJ+" \" );'>  * "+val.SJ+"</li>"
                    tmp += " </ul></div>" // Closing paragraph tag
                    arrSalelist.push([val.ATDRC_CODE, val.SJ,val.LA,val.LO]);
                });
                $("#mapsSalelist").html(tmp);

                map_load(arrSalelist[41][2], arrSalelist[41][3],arrSalelist[41][0], arrSalelist[41][1]) //지도에 리스트 상위 항목 위치 넣기 SJH
            }
        })
        
        // 분양 정보 가져오기 SJH 끝

        //리스트를 가져온 후 위치값 넣기 / 함수로 변환  varla, varlo    SJH
        function map_load(varla, varlo, strGoo, strTitle){

            var container = document.getElementById('map'); //지도를 담을 영역의 DOM 레퍼런스
            var options = { //지도를 생성할 때 필요한 기본 옵션
                center: new kakao.maps.LatLng(varla, varlo), //지도의 중심좌표.  
                level: 2 //지도의 레벨(확대, 축소 정도)
            };

            var map = new kakao.maps.Map(container, options); //지도 생성 및 객체 리턴

            var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
                mapOption = { 
            center: new kakao.maps.LatLng(varla, varlo), // 지도의 중심좌표
            level: 3 // 지도의 확대 레벨
            };
                
            // 일반 지도와 스카이뷰로 지도 타입을 전환할 수 있는 지도타입 컨트롤을 생성합니다
            var mapTypeControl = new kakao.maps.MapTypeControl();
                
            // 지도에 컨트롤을 추가해야 지도위에 표시됩니다
            // kakao.maps.ControlPosition은 컨트롤이 표시될 위치를 정의하는데 TOPRIGHT는 오른쪽 위를 의미합니다
            map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
                
            // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
            var zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
            
            // function resizeMap() {
            //     var mapContainer = document.getElementById('map');
            //         mapContainer.style.width = '650px';
            //         mapContainer.style.height = '650px'; 
            // }   

            // function relayout() {    
            // // 지도를 표시하는 div 크기를 변경한 이후 지도가 정상적으로 표출되지 않을 수도 있습니다
            // // 크기를 변경한 이후에는 반드시  map.relayout 함수를 호출해야 합니다 
            // // window의 resize 이벤트에 의한 크기변경은 map.relayout 함수가 자동으로 호출됩니다
            // map.relayout();
            // }
            // function getInfo() {
            // // 지도의 현재 중심좌표를 얻어옵니다 
            //     var center = map.getCenter(); 
            //     // 지도의 현재 영역을 얻어옵니다 
            //     var bounds = map.getBounds();
            // }
           

            var markerPosition = new kakao.maps.LatLng(varla, varlo); 

            // 마커를 생성합니다
            var marker = new kakao.maps.Marker({
                position: markerPosition
            });

            marker.setMap(map);

            var iwContent = '<div style="padding:5px;">  ' + strGoo + ' <br><a style="color:blue" target="_blank"> '+ strTitle +' </a></div>' // 인포윈도우에 표출될 내용으로 HTML 문자열이나 document element가 가능합니다
                iwPosition = new kakao.maps.LatLng(varla, varlo); //인포윈도우 표시 위치입니다

            // 인포윈도우를 생성합니다
            var infowindow = new kakao.maps.InfoWindow({
                position : iwPosition, 
                content : iwContent 
            });

            // 마커 위에 인포윈도우를 표시합니다. 두번째 파라미터인 marker를 넣어주지 않으면 지도 위에 표시됩니다
            infowindow.open(map, marker); 
        }

    </script>

    <footer>
        <div>
            <h1><a href="index.html">My Little Farm</a></h1>
            <div>
                <ul>
                    <li>운영정보
                        <ul>
                            <li><a href="Notification_information.html">질병정보</a></li>
                            <li><a href="operation_information.html ">작물 농사 방법</a></li>
                        </ul>
                    </li>
                    <li>분양정보
                        <ul>
                            <li><a href="Sale_list.html">분양리스트</a></li>
                        </ul>
                    </li>
                    <li>소통
                        <ul>
                            <li><a href="bulletin_board.html">자유 게시판</a></li>
                            <li><a href="Questions_ board.html">질문</a></li>
                            <li><a href="Notice.html">공지사항</a></li>
                        </ul>
                    </li>
                    <li>공유
                        <ul>
                            <li><a href="Selling">내 작물 판매</a></li>
                            <li><a href="Free_selling.html">내 작물 무료나눔</a></li>
                        </ul>
                    </li>
                    <li><a href="MyPage.html">마이페이지</a></li>
                </ul>
            </div>
            <div>
                <address>
                    <p>E-Mail :<a href="gksrlvy7138@gmail.com"> gksrlvy7138@gmail.com</a></p>
                    <p>" 주소 : 서울시 서초구 서초대로74길 33 비트빌 3층"</p>
                    <p>Tel :<a href="tel:+820234863456"> 02 - 3486 - 3456</a></p>
                </address>
            </div>
        </div>
    </footer>
</body>
</html>